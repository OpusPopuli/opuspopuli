# Docker Compose for E2E Testing
#
# Thin overlay on docker-compose-services.yml that adds:
#   - Container name prefixes (opuspopuli-e2e-*)
#   - API Gateway on port 4000 (avoids conflict with frontend on port 3000)
#
# Usage:
#   # Start services:
#   docker compose -f docker-compose-e2e.yml up -d --build --wait
#
#   # Run E2E tests:
#   NEXT_PUBLIC_GRAPHQL_URL=http://localhost:4000/graphql pnpm --filter frontend e2e
#
#   # Stop services:
#   docker compose -f docker-compose-e2e.yml down -v

include:
  - docker-compose-services.yml  # Infrastructure + backend microservices

services:
  # Set container names for E2E environment
  db-migrate:
    container_name: opuspopuli-e2e-db-migrate

  users:
    container_name: opuspopuli-e2e-users

  documents:
    container_name: opuspopuli-e2e-documents

  knowledge:
    container_name: opuspopuli-e2e-knowledge

  region:
    container_name: opuspopuli-e2e-region

  # API Gateway - Port 4000 to avoid conflict with frontend on port 3000
  api:
    container_name: opuspopuli-e2e-api
    ports:
      - "4000:8080"
