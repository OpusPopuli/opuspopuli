# ============================================================
# Environment Configuration
# ============================================================
# IMPORTANT: Use NODE_ENV for environment detection (Node.js standard)
# Valid values: 'development', 'production', 'test'
# Legacy values 'dev' and 'prod' are also supported but not recommended
# @see https://github.com/CommonwealthLabsCode/qckstrt/issues/206

PROJECT='qckstrt'
NODE_ENV='development'

# CORS Configuration
# In production (NODE_ENV='production'), restricts origins to this comma-separated list
# In development, all origins are allowed regardless of this setting
# ALLOWED_ORIGINS='https://yourdomain.com,https://app.yourdomain.com'

AWS_REGION='us-west-2'
# AWS_PROFILE='your-aws-profile'
# AWS_SECRETS='your-secrets-manager-secret-name'

PORT=3001
APPLICATION='vectors'
VERSION='0.0.1'
DESCRIPTION='OCR/AI Functionality'

# Embeddings Configuration (OSS default)
EMBEDDINGS_PROVIDER='xenova'
EMBEDDINGS_CHUNK_SIZE=1000
EMBEDDINGS_CHUNK_OVERLAP=200

# Xenova Configuration (OSS, in-process, zero setup)
EMBEDDINGS_XENOVA_MODEL='Xenova/all-MiniLM-L6-v2'
# Other options: 'Xenova/paraphrase-MiniLM-L3-v2' (smaller/faster)

# Ollama Configuration (OSS, requires ollama server)
# EMBEDDINGS_PROVIDER='ollama'
# EMBEDDINGS_OLLAMA_URL='http://localhost:11434'
# EMBEDDINGS_OLLAMA_MODEL='nomic-embed-text'

# LLM Configuration (OSS, self-hosted via Ollama)
LLM_URL='http://localhost:11434'
LLM_MODEL='falcon'
# Other options: llama3.2, mistral, llama3.1, qwen2.5, etc.
# See available models at: https://ollama.ai/library

# Vector Database Configuration (pgvector - uses same PostgreSQL connection)
VECTOR_DB_PROVIDER='pgvector'

# ============================================================
# Supabase Configuration (OSS - Default)
# ============================================================
# Supabase is the default provider. Start with: docker-compose up

# Supabase Connection
SUPABASE_URL='http://localhost:8000'
SUPABASE_ANON_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0'
SUPABASE_SERVICE_ROLE_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImV4cCI6MTk4MzgxMjk5Nn0.EGIM96RAZx35lJzdJsyH-qQwv8Hdp7fsn3W0YpN81IU'

# Provider Selection
AUTH_PROVIDER='supabase'
STORAGE_PROVIDER='supabase'

# ============================================================
# Secrets Provider Configuration
# ============================================================
# Options: env (default), aws, supabase
#
# env      - Read secrets from environment variables (universal adapter)
#            Works with: Docker, Kubernetes, GCP Cloud Run, Azure App Service, etc.
# aws      - Read secrets from AWS Secrets Manager
# supabase - Read secrets from Supabase Vault
#
SECRETS_PROVIDER='env'

# AWS Secrets Manager Configuration (only needed if SECRETS_PROVIDER='aws')
# AWS_REGION is already configured above
# SECRETS_CACHE_TTL=300  # Cache TTL in seconds (default: 300)

# Relational Database Configuration (Supabase PostgreSQL)
RELATIONAL_DB_PROVIDER='postgres'
RELATIONAL_DB_HOST='localhost'
RELATIONAL_DB_PORT=5432
RELATIONAL_DB_DATABASE='postgres'
RELATIONAL_DB_USERNAME='postgres'
RELATIONAL_DB_PASSWORD='your-super-secret-password'

# Database Connection Pool Configuration
# RELATIONAL_DB_POOL_MAX=20               # Maximum connections (default: 20)
# RELATIONAL_DB_POOL_MIN=5                # Minimum connections (default: 5)
# RELATIONAL_DB_IDLE_TIMEOUT_MS=30000     # Idle timeout in ms (default: 30s)
# RELATIONAL_DB_CONNECTION_TIMEOUT_MS=5000 # Connection timeout in ms (default: 5s)
# RELATIONAL_DB_ACQUIRE_TIMEOUT_MS=10000  # Acquire timeout in ms (default: 10s)

# Database Connection Retry Configuration (exponential backoff)
# Handles scenarios where database is unavailable at startup
# RELATIONAL_DB_RETRY_MAX_ATTEMPTS=5      # Max retry attempts (default: 5)
# RELATIONAL_DB_RETRY_BASE_DELAY_MS=1000  # Initial retry delay in ms (default: 1s)
# RELATIONAL_DB_RETRY_MAX_DELAY_MS=30000  # Maximum retry delay in ms (default: 30s)
# RELATIONAL_DB_RETRY_USE_JITTER=true     # Add jitter to prevent thundering herd (default: true)

# ============================================================
# Audit Log Configuration
# ============================================================
# Number of days to retain audit logs (0 = indefinite retention)
AUDIT_RETENTION_DAYS=90
# Cleanup interval in milliseconds (default: 24 hours = 86400000)
# AUDIT_CLEANUP_INTERVAL_MS=86400000

# ============================================================
# Extraction Provider Configuration
# ============================================================
# Rate limiting (token bucket algorithm)
# EXTRACTION_RATE_LIMIT_RPS=2          # Requests per second
# EXTRACTION_RATE_LIMIT_BURST=5        # Burst size

# Caching
# EXTRACTION_CACHE_TTL_MS=300000       # Cache TTL in ms (default: 5 minutes)
# EXTRACTION_CACHE_MAX_SIZE=100        # Maximum cached entries

# Timeouts and retries
# EXTRACTION_DEFAULT_TIMEOUT_MS=30000  # Request timeout (default: 30 seconds)
# EXTRACTION_RETRY_MAX_ATTEMPTS=3      # Maximum retry attempts
# EXTRACTION_RETRY_BASE_DELAY_MS=1000  # Base delay for exponential backoff
# EXTRACTION_RETRY_MAX_DELAY_MS=30000  # Maximum retry delay

# ============================================================
# Region Configuration
# ============================================================
# Region provider selection (example, california, etc.)
REGION_PROVIDER='example'
# Port for the region service
REGION_PORT=3004
# Enable/disable automatic sync (default: true)
REGION_SYNC_ENABLED='true'
# Sync schedule (cron expression, default: every day at 2 AM)
# REGION_SYNC_SCHEDULE='0 2 * * *'

# ============================================================
# Security Configuration
# ============================================================
# See docs/guides/auth-security.md for detailed architecture explanation
#
# Architecture:
#   Browser → API Gateway: CSRF + httpOnly cookies (no secrets in frontend)
#   API Gateway → Microservices: HMAC request signing
# ============================================================

# CSRF Protection (stateless double-submit cookie pattern)
# CSRF_ENABLED=true                       # Enable/disable CSRF protection
# CSRF_COOKIE_NAME='csrf-token'           # Name of the CSRF token cookie
# CSRF_HEADER_NAME='x-csrf-token'         # Name of the CSRF token header
# CSRF_TOKEN_MAX_AGE=86400000             # Token max age in ms (default: 24 hours)
# CSRF_COOKIE_DOMAIN='.yourdomain.com'    # Cookie domain (include subdomains)

# Cookie Configuration (for httpOnly JWT cookies)
# COOKIE_SECURE=true                      # Require HTTPS (auto-enabled in production)
# COOKIE_SAME_SITE='strict'               # SameSite attribute: strict, lax, none
# COOKIE_DOMAIN='.yourdomain.com'         # Cookie domain (include subdomains)
# COOKIE_ACCESS_TOKEN_MAX_AGE=900000      # Access token max age in ms (default: 15 min)
# COOKIE_REFRESH_TOKEN_MAX_AGE=604800000  # Refresh token max age in ms (default: 7 days)

# Gateway HMAC Signing (for gateway-to-microservice authentication)
# Generate a secure random secret: openssl rand -base64 32
GATEWAY_HMAC_SECRET='your-secure-gateway-hmac-secret'
GATEWAY_CLIENT_ID='api-gateway'

# API Keys Configuration (for microservices to validate gateway requests)
# This should include the gateway's HMAC secret
# API_KEYS='{"api-gateway":"your-secure-gateway-hmac-secret"}'

# ============================================================
# GraphQL Query Complexity Configuration
# ============================================================
# SECURITY: Prevents DoS attacks by limiting query depth and complexity
# @see https://github.com/CommonwealthLabsCode/qckstrt/issues/199

# Maximum query depth allowed (default: 10)
# GRAPHQL_MAX_DEPTH=10

# Maximum query complexity score allowed (default: 1000)
# GRAPHQL_MAX_COMPLEXITY=1000

# Cost per scalar field (default: 1)
# GRAPHQL_SCALAR_COST=1

# Cost per object field (default: 10)
# GRAPHQL_OBJECT_COST=10

# Multiplier for list fields (default: 10)
# GRAPHQL_LIST_FACTOR=10

# Enable complexity logging for monitoring (default: false)
# GRAPHQL_LOG_COMPLEXITY=true
